(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&l(r)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerpolicy&&(a.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?a.credentials="include":s.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();function ee(){}function nt(t){return t()}function Ue(){return Object.create(null)}function V(t){t.forEach(nt)}function Ne(t){return typeof t=="function"}function st(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function it(t){return Object.keys(t).length===0}function i(t,e){t.appendChild(e)}function M(t,e,n){t.insertBefore(e,n||null)}function N(t){t.parentNode&&t.parentNode.removeChild(t)}function Me(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function f(t){return document.createElement(t)}function C(t){return document.createTextNode(t)}function h(){return C(" ")}function Se(){return C("")}function E(t,e,n,l){return t.addEventListener(e,n,l),()=>t.removeEventListener(e,n,l)}function o(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function rt(t){return Array.from(t.childNodes)}function G(t,e){e=""+e,t.data!==e&&(t.data=e)}function H(t,e){t.value=e==null?"":e}let he;function me(t){he=t}function ot(){if(!he)throw new Error("Function called outside component initialization");return he}function at(t){ot().$$.on_mount.push(t)}const ce=[],Te=[];let fe=[];const De=[],ut=Promise.resolve();let Re=!1;function ct(){Re||(Re=!0,ut.then(lt))}function qe(t){fe.push(t)}const Le=new Set;let ue=0;function lt(){if(ue!==0)return;const t=he;do{try{for(;ue<ce.length;){const e=ce[ue];ue++,me(e),ft(e.$$)}}catch(e){throw ce.length=0,ue=0,e}for(me(null),ce.length=0,ue=0;Te.length;)Te.pop()();for(let e=0;e<fe.length;e+=1){const n=fe[e];Le.has(n)||(Le.add(n),n())}fe.length=0}while(ce.length);for(;De.length;)De.pop()();Re=!1,Le.clear(),me(t)}function ft(t){if(t.fragment!==null){t.update(),V(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(qe)}}function dt(t){const e=[],n=[];fe.forEach(l=>t.indexOf(l)===-1?e.push(l):n.push(l)),n.forEach(l=>l()),fe=e}const pt=new Set;function gt(t,e){t&&t.i&&(pt.delete(t),t.i(e))}function _t(t,e,n,l){const{fragment:s,after_update:a}=t.$$;s&&s.m(e,n),l||qe(()=>{const r=t.$$.on_mount.map(nt).filter(Ne);t.$$.on_destroy?t.$$.on_destroy.push(...r):V(r),t.$$.on_mount=[]}),a.forEach(qe)}function bt(t,e){const n=t.$$;n.fragment!==null&&(dt(n.after_update),V(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function mt(t,e){t.$$.dirty[0]===-1&&(ce.push(t),ct(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ht(t,e,n,l,s,a,r,g=[-1]){const m=he;me(t);const u=t.$$={fragment:null,ctx:[],props:a,update:ee,not_equal:s,bound:Ue(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(m?m.$$.context:[])),callbacks:Ue(),dirty:g,skip_bound:!1,root:e.target||m.$$.root};r&&r(u.root);let p=!1;if(u.ctx=n?n(t,e.props||{},(d,c,..._)=>{const v=_.length?_[0]:c;return u.ctx&&s(u.ctx[d],u.ctx[d]=v)&&(!u.skip_bound&&u.bound[d]&&u.bound[d](v),p&&mt(t,d)),c}):[],u.update(),p=!0,V(u.before_update),u.fragment=l?l(u.ctx):!1,e.target){if(e.hydrate){const d=rt(e.target);u.fragment&&u.fragment.l(d),d.forEach(N)}else u.fragment&&u.fragment.c();e.intro&&gt(t.$$.fragment),_t(t,e.target,e.anchor,e.customElement),lt()}me(m)}class vt{$destroy(){bt(this,1),this.$destroy=ee}$on(e,n){if(!Ne(n))return ee;const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(n),()=>{const s=l.indexOf(n);s!==-1&&l.splice(s,1)}}$set(e){this.$$set&&!it(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function jt(t){return window.go.main.App.AcceptFriendRequest(t)}function wt(){return window.go.main.App.GetCurrentUser()}function kt(){return window.go.main.App.GetFriendRequests()}function zt(){return window.go.main.App.GetFriends()}function yt(t,e){return window.go.main.App.GetMessages(t,e)}function Ft(){return window.go.main.App.GetMultiaddr()}function At(){return window.go.main.App.GetPeerInfo()}function Ct(){return window.go.main.App.GetUnreadCount()}function Lt(){return window.go.main.App.IsLoggedIn()}function Be(t,e){return window.go.main.App.Login(t,e)}function Rt(){return window.go.main.App.Logout()}function qt(t,e,n){return window.go.main.App.Register(t,e,n)}function Nt(t){return window.go.main.App.RejectFriendRequest(t)}function Mt(t,e){return window.go.main.App.SendFriendRequest(t,e)}function St(t,e){return window.go.main.App.SendMessage(t,e)}function Ke(t,e,n){const l=t.slice();return l[49]=e[n],l}function He(t,e,n){const l=t.slice();return l[52]=e[n],l}function We(t,e,n){const l=t.slice();return l[55]=e[n],l}function Pt(t){var Ge;let e,n,l,s,a=(((Ge=t[7])==null?void 0:Ge.fullName)||t[0])+"",r,g,m,u,p,d,c,_,v,F,k,j,S,y,R,w=(t[5]||"Loading...")+"",A,O,q,K,I,z,P,le,ve,se,ie=(t[6]||"Loading...")+"",re,de,X,oe,te,je,pe,Z,W,$,x,we,ae=t[10].length+"",ge,ke,ze,ne,ye,_e,b,Y,be,Ce,Pe,U=t[8]&&Ye(t),T=t[11].length>0&&Je(t),D=t[15]&&Ve(t);function Ie(L,B){return L[10].length===0?Gt:Et}let Fe=Ie(t),J=Fe(t);function Ee(L,B){return L[12]?Ut:Ot}let Ae=Ee(t),Q=Ae(t);return{c(){e=f("div"),n=f("div"),l=f("h2"),s=C("Welcome, "),r=C(a),g=C("!"),m=h(),u=f("button"),u.textContent="Logout",p=h(),U&&U.c(),d=h(),c=f("div"),_=f("h3"),_.textContent="Your Peer Info",v=h(),F=f("div"),k=f("div"),j=f("div"),S=f("strong"),S.textContent="Peer ID:",y=h(),R=f("code"),A=C(w),O=h(),q=f("button"),q.textContent="\u{1F4CB} Copy",K=h(),I=f("div"),z=f("div"),P=f("div"),le=f("strong"),le.textContent="Multiaddress:",ve=h(),se=f("code"),re=C(ie),de=h(),X=f("button"),X.textContent="\u{1F4CB} Copy",oe=h(),te=f("div"),te.innerHTML=`<span class="status-indicator online svelte-1g4jbz2"></span> 
          <span>Connected to P2P Network</span>`,je=h(),T&&T.c(),pe=h(),Z=f("div"),W=f("div"),$=f("div"),x=f("h3"),we=C("Friends ("),ge=C(ae),ke=C(")"),ze=h(),ne=f("button"),ne.textContent="+ Add",ye=h(),D&&D.c(),_e=h(),b=f("div"),J.c(),Y=h(),be=f("div"),Q.c(),o(l,"class","svelte-1g4jbz2"),o(u,"class","btn-logout svelte-1g4jbz2"),o(n,"class","header svelte-1g4jbz2"),o(_,"class","svelte-1g4jbz2"),o(S,"class","svelte-1g4jbz2"),o(R,"class","svelte-1g4jbz2"),o(j,"class","info-content svelte-1g4jbz2"),o(q,"class","btn-copy svelte-1g4jbz2"),o(k,"class","info-row svelte-1g4jbz2"),o(F,"class","peer-info svelte-1g4jbz2"),o(le,"class","svelte-1g4jbz2"),o(se,"class","svelte-1g4jbz2"),o(P,"class","info-content svelte-1g4jbz2"),o(X,"class","btn-copy svelte-1g4jbz2"),o(z,"class","info-row svelte-1g4jbz2"),o(I,"class","peer-info svelte-1g4jbz2"),o(c,"class","info-card svelte-1g4jbz2"),o(te,"class","status svelte-1g4jbz2"),o(x,"class","svelte-1g4jbz2"),o(ne,"class","btn-add svelte-1g4jbz2"),o($,"class","sidebar-header svelte-1g4jbz2"),o(b,"class","friends-list svelte-1g4jbz2"),o(W,"class","friends-sidebar svelte-1g4jbz2"),o(be,"class","chat-area svelte-1g4jbz2"),o(Z,"class","main-content svelte-1g4jbz2"),o(e,"class","chat-section svelte-1g4jbz2")},m(L,B){M(L,e,B),i(e,n),i(n,l),i(l,s),i(l,r),i(l,g),i(n,m),i(n,u),i(e,p),U&&U.m(e,null),i(e,d),i(e,c),i(c,_),i(c,v),i(c,F),i(F,k),i(k,j),i(j,S),i(j,y),i(j,R),i(R,A),i(k,O),i(k,q),i(c,K),i(c,I),i(I,z),i(z,P),i(P,le),i(P,ve),i(P,se),i(se,re),i(z,de),i(z,X),i(e,oe),i(e,te),i(e,je),T&&T.m(e,null),i(e,pe),i(e,Z),i(Z,W),i(W,$),i($,x),i(x,we),i(x,ge),i(x,ke),i($,ze),i($,ne),i(W,ye),D&&D.m(W,null),i(W,_e),i(W,b),J.m(b,null),i(Z,Y),i(Z,be),Q.m(be,null),Ce||(Pe=[E(u,"click",t[20]),E(q,"click",t[31]),E(X,"click",t[32]),E(ne,"click",t[35])],Ce=!0)},p(L,B){var Oe;B[0]&129&&a!==(a=(((Oe=L[7])==null?void 0:Oe.fullName)||L[0])+"")&&G(r,a),L[8]?U?U.p(L,B):(U=Ye(L),U.c(),U.m(e,d)):U&&(U.d(1),U=null),B[0]&32&&w!==(w=(L[5]||"Loading...")+"")&&G(A,w),B[0]&64&&ie!==(ie=(L[6]||"Loading...")+"")&&G(re,ie),L[11].length>0?T?T.p(L,B):(T=Je(L),T.c(),T.m(e,pe)):T&&(T.d(1),T=null),B[0]&1024&&ae!==(ae=L[10].length+"")&&G(ge,ae),L[15]?D?D.p(L,B):(D=Ve(L),D.c(),D.m(W,_e)):D&&(D.d(1),D=null),Fe===(Fe=Ie(L))&&J?J.p(L,B):(J.d(1),J=Fe(L),J&&(J.c(),J.m(b,null))),Ae===(Ae=Ee(L))&&Q?Q.p(L,B):(Q.d(1),Q=Ae(L),Q&&(Q.c(),Q.m(be,null)))},d(L){L&&N(e),U&&U.d(),T&&T.d(),D&&D.d(),J.d(),Q.d(),Ce=!1,V(Pe)}}}function It(t){let e,n,l=t[4]?"Register":"Login",s,a,r,g,m,u,p,d,c,_=t[9]?"Please wait...":t[4]?"Register":"Login",v,F,k,j=t[4]?"Already have an account? Login":"Need an account? Register",S,y,R,w=t[8]&&xe(t),A=t[4]&&et(t);return{c(){e=f("div"),n=f("h2"),s=C(l),a=h(),w&&w.c(),r=h(),g=f("input"),m=h(),u=f("input"),p=h(),A&&A.c(),d=h(),c=f("button"),v=C(_),F=h(),k=f("button"),S=C(j),o(n,"class","svelte-1g4jbz2"),o(g,"type","text"),o(g,"placeholder","Username"),o(g,"class","input svelte-1g4jbz2"),g.disabled=t[9],o(u,"type","password"),o(u,"placeholder","Password"),o(u,"class","input svelte-1g4jbz2"),u.disabled=t[9],o(c,"class","btn-primary svelte-1g4jbz2"),c.disabled=t[9],o(k,"class","btn-secondary svelte-1g4jbz2"),k.disabled=t[9],o(e,"class","auth-section svelte-1g4jbz2")},m(O,q){M(O,e,q),i(e,n),i(n,s),i(e,a),w&&w.m(e,null),i(e,r),i(e,g),H(g,t[0]),i(e,m),i(e,u),H(u,t[1]),i(e,p),A&&A.m(e,null),i(e,d),i(e,c),i(c,v),i(e,F),i(e,k),i(k,S),y||(R=[E(g,"input",t[28]),E(u,"input",t[29]),E(c,"click",function(){Ne(t[4]?t[19]:t[18])&&(t[4]?t[19]:t[18]).apply(this,arguments)}),E(k,"click",t[21])],y=!0)},p(O,q){t=O,q[0]&16&&l!==(l=t[4]?"Register":"Login")&&G(s,l),t[8]?w?w.p(t,q):(w=xe(t),w.c(),w.m(e,r)):w&&(w.d(1),w=null),q[0]&512&&(g.disabled=t[9]),q[0]&1&&g.value!==t[0]&&H(g,t[0]),q[0]&512&&(u.disabled=t[9]),q[0]&2&&u.value!==t[1]&&H(u,t[1]),t[4]?A?A.p(t,q):(A=et(t),A.c(),A.m(e,d)):A&&(A.d(1),A=null),q[0]&528&&_!==(_=t[9]?"Please wait...":t[4]?"Register":"Login")&&G(v,_),q[0]&512&&(c.disabled=t[9]),q[0]&16&&j!==(j=t[4]?"Already have an account? Login":"Need an account? Register")&&G(S,j),q[0]&512&&(k.disabled=t[9])},d(O){O&&N(e),w&&w.d(),A&&A.d(),y=!1,V(R)}}}function Ye(t){let e,n;return{c(){e=f("div"),n=C(t[8]),o(e,"class","error svelte-1g4jbz2")},m(l,s){M(l,e,s),i(e,n)},p(l,s){s[0]&256&&G(n,l[8])},d(l){l&&N(e)}}}function Je(t){let e,n,l,s=t[11].length+"",a,r,g,m=t[11],u=[];for(let p=0;p<m.length;p+=1)u[p]=Qe(We(t,m,p));return{c(){e=f("div"),n=f("h3"),l=C("Friend Requests ("),a=C(s),r=C(")"),g=h();for(let p=0;p<u.length;p+=1)u[p].c();o(n,"class","svelte-1g4jbz2"),o(e,"class","friend-requests svelte-1g4jbz2")},m(p,d){M(p,e,d),i(e,n),i(n,l),i(n,a),i(n,r),i(e,g);for(let c=0;c<u.length;c+=1)u[c]&&u[c].m(e,null)},p(p,d){if(d[0]&2048&&s!==(s=p[11].length+"")&&G(a,s),d[0]&25167872){m=p[11];let c;for(c=0;c<m.length;c+=1){const _=We(p,m,c);u[c]?u[c].p(_,d):(u[c]=Qe(_),u[c].c(),u[c].m(e,null))}for(;c<u.length;c+=1)u[c].d(1);u.length=m.length}},d(p){p&&N(e),Me(u,p)}}}function Qe(t){let e,n,l,s=t[55].fullName+"",a,r,g,m,u=t[55].username+"",p,d,c,_,v,F,k,j,S;function y(){return t[33](t[55])}function R(){return t[34](t[55])}return{c(){e=f("div"),n=f("div"),l=f("strong"),a=C(s),r=h(),g=f("span"),m=C("@"),p=C(u),d=h(),c=f("div"),_=f("button"),_.textContent="\u2713 Accept",v=h(),F=f("button"),F.textContent="\u2717 Reject",k=h(),o(g,"class","username svelte-1g4jbz2"),o(n,"class","request-info svelte-1g4jbz2"),o(_,"class","btn-accept svelte-1g4jbz2"),o(F,"class","btn-reject svelte-1g4jbz2"),o(c,"class","request-actions svelte-1g4jbz2"),o(e,"class","request-item svelte-1g4jbz2")},m(w,A){M(w,e,A),i(e,n),i(n,l),i(l,a),i(n,r),i(n,g),i(g,m),i(g,p),i(e,d),i(e,c),i(c,_),i(c,v),i(c,F),i(e,k),j||(S=[E(_,"click",y),E(F,"click",R)],j=!0)},p(w,A){t=w,A[0]&2048&&s!==(s=t[55].fullName+"")&&G(a,s),A[0]&2048&&u!==(u=t[55].username+"")&&G(p,u)},d(w){w&&N(e),j=!1,V(S)}}}function Ve(t){let e,n,l,s,a,r,g,m,u,p,d,c;return{c(){e=f("div"),n=f("input"),l=h(),s=f("input"),a=h(),r=f("div"),g=f("button"),m=C("Send Request"),u=h(),p=f("button"),p.textContent="Cancel",o(n,"type","text"),o(n,"placeholder","Friend's Multiaddress"),o(n,"class","input-small svelte-1g4jbz2"),o(s,"type","text"),o(s,"placeholder","Friend's Username"),o(s,"class","input-small svelte-1g4jbz2"),o(g,"class","btn-submit svelte-1g4jbz2"),g.disabled=t[9],o(p,"class","btn-cancel svelte-1g4jbz2"),o(r,"class","form-actions svelte-1g4jbz2"),o(e,"class","add-friend-form svelte-1g4jbz2")},m(_,v){M(_,e,v),i(e,n),H(n,t[16]),i(e,l),i(e,s),H(s,t[17]),i(e,a),i(e,r),i(r,g),i(g,m),i(r,u),i(r,p),d||(c=[E(n,"input",t[36]),E(s,"input",t[37]),E(g,"click",t[22]),E(p,"click",t[38])],d=!0)},p(_,v){v[0]&65536&&n.value!==_[16]&&H(n,_[16]),v[0]&131072&&s.value!==_[17]&&H(s,_[17]),v[0]&512&&(g.disabled=_[9])},d(_){_&&N(e),d=!1,V(c)}}}function Et(t){let e,n=t[10],l=[];for(let s=0;s<n.length;s+=1)l[s]=Xe(He(t,n,s));return{c(){for(let s=0;s<l.length;s+=1)l[s].c();e=Se()},m(s,a){for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(s,a);M(s,e,a)},p(s,a){if(a[0]&33559552){n=s[10];let r;for(r=0;r<n.length;r+=1){const g=He(s,n,r);l[r]?l[r].p(g,a):(l[r]=Xe(g),l[r].c(),l[r].m(e.parentNode,e))}for(;r<l.length;r+=1)l[r].d(1);l.length=n.length}},d(s){Me(l,s),s&&N(e)}}}function Gt(t){let e;return{c(){e=f("p"),e.textContent="No friends yet. Add someone to get started!",o(e,"class","empty-state svelte-1g4jbz2")},m(n,l){M(n,e,l)},p:ee,d(n){n&&N(e)}}}function Xe(t){let e,n,l,s,a,r,g=t[52].fullName+"",m,u,p,d,c=t[52].username+"",_,v,F,k,j;function S(){return t[39](t[52])}return{c(){var y;e=f("div"),n=f("span"),s=h(),a=f("div"),r=f("strong"),m=C(g),u=h(),p=f("span"),d=C("@"),_=C(c),v=h(),o(n,"class",l="status-dot "+(t[52].online?"online":"offline")+" svelte-1g4jbz2"),o(p,"class","username svelte-1g4jbz2"),o(a,"class","friend-info svelte-1g4jbz2"),o(e,"class",F="friend-item "+(((y=t[12])==null?void 0:y.username)===t[52].username?"selected":"")+" svelte-1g4jbz2")},m(y,R){M(y,e,R),i(e,n),i(e,s),i(e,a),i(a,r),i(r,m),i(a,u),i(a,p),i(p,d),i(p,_),i(e,v),k||(j=E(e,"click",S),k=!0)},p(y,R){var w;t=y,R[0]&1024&&l!==(l="status-dot "+(t[52].online?"online":"offline")+" svelte-1g4jbz2")&&o(n,"class",l),R[0]&1024&&g!==(g=t[52].fullName+"")&&G(m,g),R[0]&1024&&c!==(c=t[52].username+"")&&G(_,c),R[0]&5120&&F!==(F="friend-item "+(((w=t[12])==null?void 0:w.username)===t[52].username?"selected":"")+" svelte-1g4jbz2")&&o(e,"class",F)},d(y){y&&N(e),k=!1,j()}}}function Ot(t){let e;return{c(){e=f("div"),e.innerHTML="<p>Select a friend to start chatting</p>",o(e,"class","no-selection svelte-1g4jbz2")},m(n,l){M(n,e,l)},p:ee,d(n){n&&N(e)}}}function Ut(t){let e,n,l,s=t[12].fullName+"",a,r,g,m,u,p,d=t[12].online?"Online":"Offline",c,_,v,F,k,j,S,y,R,w,A,O;function q(z,P){return z[13].length===0?Dt:Tt}let K=q(t),I=K(t);return{c(){e=f("div"),n=f("div"),l=f("h3"),a=C(s),r=h(),g=f("span"),m=f("span"),p=h(),c=C(d),_=h(),v=f("div"),I.c(),F=h(),k=f("div"),j=f("input"),S=h(),y=f("button"),R=C("Send"),o(l,"class","svelte-1g4jbz2"),o(m,"class",u="status-dot "+(t[12].online?"online":"offline")+" svelte-1g4jbz2"),o(g,"class","chat-status svelte-1g4jbz2"),o(e,"class","chat-header svelte-1g4jbz2"),o(v,"class","messages-container svelte-1g4jbz2"),o(j,"type","text"),o(j,"placeholder","Type a message..."),o(j,"class","message-input svelte-1g4jbz2"),o(y,"class","btn-send svelte-1g4jbz2"),y.disabled=w=!t[14].trim(),o(k,"class","message-input-container svelte-1g4jbz2")},m(z,P){M(z,e,P),i(e,n),i(n,l),i(l,a),i(n,r),i(n,g),i(g,m),i(g,p),i(g,c),M(z,_,P),M(z,v,P),I.m(v,null),M(z,F,P),M(z,k,P),i(k,j),H(j,t[14]),i(k,S),i(k,y),i(y,R),A||(O=[E(j,"input",t[40]),E(j,"keypress",t[27]),E(y,"click",t[26])],A=!0)},p(z,P){P[0]&4096&&s!==(s=z[12].fullName+"")&&G(a,s),P[0]&4096&&u!==(u="status-dot "+(z[12].online?"online":"offline")+" svelte-1g4jbz2")&&o(m,"class",u),P[0]&4096&&d!==(d=z[12].online?"Online":"Offline")&&G(c,d),K===(K=q(z))&&I?I.p(z,P):(I.d(1),I=K(z),I&&(I.c(),I.m(v,null))),P[0]&16384&&j.value!==z[14]&&H(j,z[14]),P[0]&16384&&w!==(w=!z[14].trim())&&(y.disabled=w)},d(z){z&&N(e),z&&N(_),z&&N(v),I.d(),z&&N(F),z&&N(k),A=!1,V(O)}}}function Tt(t){let e,n=t[13],l=[];for(let s=0;s<n.length;s+=1)l[s]=$e(Ke(t,n,s));return{c(){for(let s=0;s<l.length;s+=1)l[s].c();e=Se()},m(s,a){for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(s,a);M(s,e,a)},p(s,a){if(a[0]&8192){n=s[13];let r;for(r=0;r<n.length;r+=1){const g=Ke(s,n,r);l[r]?l[r].p(g,a):(l[r]=$e(g),l[r].c(),l[r].m(e.parentNode,e))}for(;r<l.length;r+=1)l[r].d(1);l.length=n.length}},d(s){Me(l,s),s&&N(e)}}}function Dt(t){let e;return{c(){e=f("p"),e.textContent="No messages yet. Start the conversation!",o(e,"class","empty-state svelte-1g4jbz2")},m(n,l){M(n,e,l)},p:ee,d(n){n&&N(e)}}}function Ze(t){let e;function n(a,r){if(a[49].read)return Kt;if(a[49].delivered)return Bt}let l=n(t),s=l&&l(t);return{c(){s&&s.c(),e=Se()},m(a,r){s&&s.m(a,r),M(a,e,r)},p(a,r){l!==(l=n(a))&&(s&&s.d(1),s=l&&l(a),s&&(s.c(),s.m(e.parentNode,e)))},d(a){s&&s.d(a),a&&N(e)}}}function Bt(t){let e;return{c(){e=f("span"),e.textContent="\u2713",o(e,"class","status-icon svelte-1g4jbz2")},m(n,l){M(n,e,l)},d(n){n&&N(e)}}}function Kt(t){let e;return{c(){e=f("span"),e.textContent="\u2713\u2713",o(e,"class","status-icon svelte-1g4jbz2")},m(n,l){M(n,e,l)},d(n){n&&N(e)}}}function $e(t){let e,n,l=t[49].content+"",s,a,r,g=t[49].createdAt+"",m,u,p,d,c=t[49].fromMe&&Ze(t);return{c(){e=f("div"),n=f("div"),s=C(l),a=h(),r=f("div"),m=C(g),u=h(),c&&c.c(),p=h(),o(n,"class","message-content svelte-1g4jbz2"),o(r,"class","message-meta svelte-1g4jbz2"),o(e,"class",d="message "+(t[49].fromMe?"sent":"received")+" svelte-1g4jbz2")},m(_,v){M(_,e,v),i(e,n),i(n,s),i(e,a),i(e,r),i(r,m),i(r,u),c&&c.m(r,null),i(e,p)},p(_,v){v[0]&8192&&l!==(l=_[49].content+"")&&G(s,l),v[0]&8192&&g!==(g=_[49].createdAt+"")&&G(m,g),_[49].fromMe?c?c.p(_,v):(c=Ze(_),c.c(),c.m(r,null)):c&&(c.d(1),c=null),v[0]&8192&&d!==(d="message "+(_[49].fromMe?"sent":"received")+" svelte-1g4jbz2")&&o(e,"class",d)},d(_){_&&N(e),c&&c.d()}}}function xe(t){let e,n;return{c(){e=f("div"),n=C(t[8]),o(e,"class","error svelte-1g4jbz2")},m(l,s){M(l,e,s),i(e,n)},p(l,s){s[0]&256&&G(n,l[8])},d(l){l&&N(e)}}}function et(t){let e,n,l;return{c(){e=f("input"),o(e,"type","text"),o(e,"placeholder","Full Name"),o(e,"class","input svelte-1g4jbz2"),e.disabled=t[9]},m(s,a){M(s,e,a),H(e,t[2]),n||(l=E(e,"input",t[30]),n=!0)},p(s,a){a[0]&512&&(e.disabled=s[9]),a[0]&4&&e.value!==s[2]&&H(e,s[2])},d(s){s&&N(e),n=!1,l()}}}function Ht(t){let e,n,l,s,a,r;function g(p,d){return p[3]?Pt:It}let m=g(t),u=m(t);return{c(){e=f("main"),n=f("div"),l=f("h1"),l.textContent="\u{1F92B} Whisper",s=h(),a=f("p"),a.textContent="Decentralized P2P Chat",r=h(),u.c(),o(l,"class","svelte-1g4jbz2"),o(a,"class","subtitle svelte-1g4jbz2"),o(n,"class","container svelte-1g4jbz2"),o(e,"class","svelte-1g4jbz2")},m(p,d){M(p,e,d),i(e,n),i(n,l),i(n,s),i(n,a),i(n,r),u.m(n,null)},p(p,d){m===(m=g(p))&&u?u.p(p,d):(u.d(1),u=m(p),u&&(u.c(),u.m(n,null)))},i:ee,o:ee,d(p){p&&N(e),u.d()}}}function tt(t,e){navigator.clipboard.writeText(t).then(()=>{alert(`${e} copied to clipboard!`)}).catch(n=>{console.error("Failed to copy:",n),alert("Failed to copy to clipboard")})}function Wt(t,e,n){let l="",s="",a="",r=!1,g=!1,m="",u="",p=null,d="",c=!1,_=[],v=[],F=null,k=[],j="",S=!1,y="",R="",w=0,A;at(async()=>{try{n(3,r=await Lt()),r&&(await q(),O())}catch(b){console.error("Failed to check login status:",b),n(8,d=b.toString())}});function O(){A=setInterval(async()=>{r&&(await K(),await I(),await z(),F&&await oe(F.username))},3e3)}async function q(){try{n(7,p=await wt()),n(5,m=await At()),n(6,u=await Ft()),n(0,l=(p==null?void 0:p.username)||""),await K(),await I(),await z()}catch(b){console.error("Failed to load user data:",b)}}async function K(){try{n(10,_=await zt())}catch(b){console.error("Failed to refresh friends:",b)}}async function I(){try{n(11,v=await kt())}catch(b){console.error("Failed to refresh friend requests:",b)}}async function z(){try{w=await Ct()}catch(b){console.error("Failed to refresh unread count:",b)}}async function P(){if(!l||!s){n(8,d="Username and password are required");return}n(9,c=!0),n(8,d="");try{await Be(l,s),n(3,r=!0),await q(),O(),n(1,s="")}catch(b){n(8,d=b.toString()||"Login failed"),console.error("Login error:",b)}finally{n(9,c=!1)}}async function le(){if(!l||!s||!a){n(8,d="All fields are required");return}if(s.length<8){n(8,d="Password must be at least 8 characters");return}n(9,c=!0),n(8,d="");try{await qt(l,s,a),await Be(l,s),n(3,r=!0),await q(),O(),n(1,s=""),n(4,g=!1)}catch(b){n(8,d=b.toString()||"Registration failed"),console.error("Registration error:",b)}finally{n(9,c=!1)}}async function ve(){try{A&&clearInterval(A),await Rt(),n(3,r=!1),n(7,p=null),n(10,_=[]),n(11,v=[]),n(12,F=null),n(13,k=[]),n(0,l=""),n(1,s="")}catch(b){n(8,d="Failed to logout: "+b.toString())}}function se(){n(4,g=!g),n(8,d=""),n(1,s="")}async function ie(){if(!y||!R){n(8,d="Both multiaddress and username are required");return}n(9,c=!0),n(8,d="");try{await Mt(y,R),n(16,y=""),n(17,R=""),n(15,S=!1),await K(),alert("Friend request sent!")}catch(b){n(8,d="Failed to send friend request: "+b.toString())}finally{n(9,c=!1)}}async function re(b){try{await jt(b),await I(),await K(),alert(`Friend request from ${b} accepted!`)}catch(Y){n(8,d="Failed to accept friend request: "+Y.toString())}}async function de(b){try{await Nt(b),await I(),alert(`Friend request from ${b} rejected`)}catch(Y){n(8,d="Failed to reject friend request: "+Y.toString())}}async function X(b){n(12,F=b),await oe(b.username)}async function oe(b){try{n(13,k=await yt(b,50))}catch(Y){console.error("Failed to load messages:",Y),n(8,d="Failed to load messages: "+Y.toString())}}async function te(){if(!j.trim()||!F)return;const b=j;n(14,j="");try{await St(F.username,b),await oe(F.username)}catch(Y){n(8,d="Failed to send message: "+Y.toString()),n(14,j=b)}}function je(b){b.key==="Enter"&&!b.shiftKey&&(b.preventDefault(),te())}function pe(){l=this.value,n(0,l)}function Z(){s=this.value,n(1,s)}function W(){a=this.value,n(2,a)}const $=()=>tt(m,"Peer ID"),x=()=>tt(u,"Multiaddress"),we=b=>re(b.username),ae=b=>de(b.username),ge=()=>n(15,S=!S);function ke(){y=this.value,n(16,y)}function ze(){R=this.value,n(17,R)}const ne=()=>n(15,S=!1),ye=b=>X(b);function _e(){j=this.value,n(14,j)}return[l,s,a,r,g,m,u,p,d,c,_,v,F,k,j,S,y,R,P,le,ve,se,ie,re,de,X,te,je,pe,Z,W,$,x,we,ae,ge,ke,ze,ne,ye,_e]}class Yt extends vt{constructor(e){super(),ht(this,e,Wt,Ht,st,{},null,[-1,-1])}}new Yt({target:document.getElementById("app")});
